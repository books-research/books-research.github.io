<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Insertion Sort - Java Data Structures and Algorithms for Beginners</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/ferris.css">
        <link rel="stylesheet" href="theme/semantic-notes.css">
        <link rel="stylesheet" href="theme/listing.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Java Data Structures and Algorithms for Beginners</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
body {
  text-align: justify;
}
</style>
<h2 id="insertion-sort"><a class="header" href="#insertion-sort">Insertion Sort</a></h2>
<h3 id="definition-and-concepts"><a class="header" href="#definition-and-concepts">Definition and Concepts</a></h3>
<p>Insertion Sort is a simple sorting algorithm that builds a sorted array one element at a time by taking each element from the unsorted portion and inserting it into its correct position in the sorted portion. The algorithm maintains a sorted subarray at the beginning, which grows with each iteration as elements are inserted in their proper order. You can visualize Insertion Sort as sorting a hand of playing cards, where you pick one card at a time and place it in the correct position among the already-sorted cards. In Java, Insertion Sort is typically implemented on arrays due to their direct index-based access, which facilitates shifting elements during insertion. Insertion Sort is a stable algorithm, preserving the relative order of equal elements, and it is in-place, requiring minimal extra memory.</p>
<h5 id="key-points"><a class="header" href="#key-points">Key Points:</a></h5>
<ul>
<li>Insertion Sort divides the array into a sorted and an unsorted portion.</li>
<li>Each iteration takes an element from the unsorted portion and inserts it into the sorted portion.</li>
<li>The algorithm is efficient for small or nearly sorted datasets due to its adaptive nature.</li>
<li>It is easy to implement and understand, making it ideal for beginners.</li>
</ul>
<h3 id="why-use-it"><a class="header" href="#why-use-it">Why Use It?</a></h3>
<p>Insertion Sort is used for its simplicity and efficiency in sorting small datasets or nearly sorted arrays, where it performs well due to its adaptive nature. The algorithm requires minimal extra memory, as it sorts in-place, making it suitable for memory-constrained environments. Insertion Sort is particularly effective when the data is already partially sorted, as it can terminate early for each element once its position is found. It is also valuable for educational purposes, helping students understand sorting through its intuitive insertion process. For large datasets, however, more efficient algorithms like Quick Sort or Merge Sort are recommended.</p>
<h3 id="where-to-use-real-life-examples"><a class="header" href="#where-to-use-real-life-examples">Where to Use? (Real-Life Examples)</a></h3>
<ul>
<li><strong>Teaching Sorting Algorithms</strong>: Insertion Sort is used in classrooms to teach sorting concepts due to its intuitive approach of building a sorted portion incrementally.</li>
<li><strong>Small Data Sorting</strong>: Embedded systems with limited resources use Insertion Sort to sort small lists, such as sensor data, where simplicity and low memory usage are critical.</li>
<li><strong>Nearly Sorted Data</strong>: Applications like online leaderboards use Insertion Sort to maintain nearly sorted lists, as it efficiently handles small updates with few shifts.</li>
<li><strong>Incremental Data Processing</strong>: Real-time systems processing incoming data streams use Insertion Sort to insert new elements into a sorted list, such as in event logging.</li>
</ul>
<!-- ### Diagram
diagram for Insertion Sort illustrating the process with the array [5, 3, 8, 1, 9].
<div style="text-align:center;">
    <img src="img/insertion_sort_diagram.svg" alt="inSort" style="max-width:500px; height:auto;"/>
</div> -->
<h3 id="explain-operations"><a class="header" href="#explain-operations">Explain Operations</a></h3>
<ul>
<li><strong>Selection</strong>: This operation selects the next element from the unsorted portion to be inserted into the sorted portion. It has a time complexity of O(1).</li>
<li><strong>Comparison and Shift</strong>: This operation compares the selected element with elements in the sorted portion, shifting larger elements to the right until the correct position is found. It has a time complexity of O(n) in the worst case for n elements in the sorted portion.</li>
<li><strong>Insertion</strong>: This operation places the selected element in its correct position after shifting. It has a time complexity of O(1).</li>
<li><strong>Full Algorithm</strong>: This operation involves iterating through the array, performing selection, comparison, and insertion for each element. It has a time complexity of O(n²) in the worst and average cases.</li>
</ul>
<h3 id="java-implementation"><a class="header" href="#java-implementation">Java Implementation</a></h3>
<p>The following Java code implements Insertion Sort for an array of integers.</p>
<pre><code class="language-java">public class InsertionSort {
    // Insertion Sort: Sorts an array in ascending order
    public void insertionSort(int[] arr) {
        if (arr == null || arr.length &lt;= 1) {
            return; // No sorting needed for null or single-element arrays
        }
        int n = arr.length;
        for (int i = 1; i &lt; n; i++) { // Start from second element
            int key = arr[i]; // Select element to insert
            int j = i - 1; // Last index of sorted portion
            while (j &gt;= 0 &amp;&amp; arr[j] &gt; key) { // Shift larger elements
                arr[j + 1] = arr[j];
                j--;
            }
            arr[j + 1] = key; // Insert key in correct position
        }
    }
}
</code></pre>
<h3 id="how-it-works"><a class="header" href="#how-it-works">How It Works</a></h3>
<ol>
<li><strong>Check Input</strong>:
<ul>
<li>The <code>insertionSort</code> method checks if the input array is null or has one or fewer elements. If so, it returns immediately, as no sorting is needed.</li>
</ul>
</li>
<li><strong>Outer Loop (Selection)</strong>:
<ul>
<li>The outer loop iterates from the second element (index 1) to the last element (index n-1), selecting each element (<code>key</code>) from the unsorted portion.</li>
<li>For example, in the array <code>[5, 3, 8, 1, 9]</code>, the first iteration selects <code>key = 3</code>.</li>
</ul>
</li>
<li><strong>Inner Loop (Comparison and Shift)</strong>:
<ul>
<li>The inner loop compares the <code>key</code> with elements in the sorted portion (from index <code>i-1</code> backward to 0), shifting larger elements one position to the right.</li>
<li>For example, when inserting <code>3</code>, the element <code>5</code> is shifted to index 1, resulting in <code>[5, 5, 8, 1, 9]</code>.</li>
</ul>
</li>
<li><strong>Insertion</strong>:
<ul>
<li>After the inner loop finds the correct position (when <code>arr[j] &lt;= key</code> or <code>j &lt; 0</code>), the <code>key</code> is placed at index <code>j+1</code>.</li>
<li>For example, <code>3</code> is inserted at index 0, resulting in <code>[3, 5, 8, 1, 9]</code>.</li>
</ul>
</li>
<li><strong>Result</strong>:
<ul>
<li>After all iterations, the array is sorted in ascending order. For example, <code>[5, 3, 8, 1, 9]</code> becomes <code>[1, 3, 5, 8, 9]</code>.</li>
</ul>
</li>
</ol>
<h3 id="complexity-analysis-table"><a class="header" href="#complexity-analysis-table">Complexity Analysis Table</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th><th>Space Complexity</th></tr></thead><tbody>
<tr><td>Selection</td><td>O(1)</td><td>O(1)</td></tr>
<tr><td>Comparison and Shift</td><td>O(n)</td><td>O(1)</td></tr>
<tr><td>Insertion</td><td>O(1)</td><td>O(1)</td></tr>
<tr><td>Full Algorithm</td><td>O(n) (best)</td><td>O(1)</td></tr>
<tr><td>Full Algorithm</td><td>O(n²) (average/worst)</td><td>O(1)</td></tr>
</tbody></table>
</div>
<p><em>Note</em>:</p>
<ul>
<li>n is the number of elements in the array.</li>
<li>Best case (O(n)) occurs when the array is already sorted, requiring minimal comparisons and no shifts.</li>
<li>Average and worst cases (O(n²)) involve up to n iterations, each with up to n comparisons and shifts.</li>
<li>Space complexity is O(1), as Insertion Sort is in-place, using only a few variables.</li>
</ul>
<h3 id="key-differences--notes"><a class="header" href="#key-differences--notes">Key Differences / Notes</a></h3>
<ul>
<li><strong>Insertion Sort vs. Bubble Sort</strong>:
<ul>
<li>Insertion Sort is more efficient for nearly sorted arrays, as it requires fewer shifts than Bubble Sort’s multiple swaps per pass.</li>
<li>Both have O(n²) worst-case time complexity, but Insertion Sort is adaptive, performing better on partially sorted data.</li>
</ul>
</li>
<li><strong>Insertion Sort vs. Selection Sort</strong>:
<ul>
<li>Insertion Sort is stable, preserving the order of equal elements, while Selection Sort is not.</li>
<li>Insertion Sort performs better for nearly sorted arrays, while Selection Sort performs a fixed number of comparisons regardless of input order.</li>
</ul>
</li>
<li><strong>Insertion Sort vs. Other Sorting Algorithms</strong>:
<ul>
<li>Insertion Sort is less efficient than Quick Sort (O(n log n) average) or Merge Sort (O(n log n)) for large datasets but excels in small or nearly sorted cases.</li>
<li>It is in-place, unlike Merge Sort, which requires O(n) extra space.</li>
</ul>
</li>
<li><strong>Suitability for Data Structures</strong>:
<ul>
<li>Insertion Sort is most efficient for arrays due to O(1) access and shift operations. It is less practical for linked lists (though feasible) due to traversal costs.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>✅ Tip</strong>: Use Insertion Sort for small arrays or nearly sorted data to leverage its adaptive nature and minimal memory usage. Test with edge cases like empty, single-element, or already sorted arrays to ensure robustness.</p>
</blockquote>
<blockquote>
<p><strong>⚠ Warning</strong>: Avoid using Insertion Sort for large datasets due to its O(n²) time complexity in average and worst cases, which is inefficient compared to Quick Sort or Merge Sort. Always validate array bounds to prevent <code>ArrayIndexOutOfBoundsException</code>.</p>
</blockquote>
<h3 id="exercises"><a class="header" href="#exercises">Exercises</a></h3>
<ol>
<li><strong>Basic Insertion Sort</strong>: Implement Insertion Sort for an array of integers and test it with various inputs (e.g., unsorted, sorted, reversed, duplicates). Count the number of shifts performed.</li>
<li><strong>Descending Order</strong>: Modify the Insertion Sort implementation to sort an array in descending order by adjusting the comparison logic. Test with different array sizes.</li>
<li><strong>Performance Analysis</strong>: Write a program that measures the execution time of Insertion Sort for arrays of increasing sizes (e.g., 10, 100, 1000 elements). Compare with Bubble Sort and Selection Sort.</li>
<li><strong>Object Sorting</strong>: Extend Insertion Sort to sort an array of objects (e.g., <code>Student</code> objects with a <code>grade</code> field) based on a custom comparator. Test with a sample dataset.</li>
<li><strong>Nearly Sorted Arrays</strong>: Implement Insertion Sort and test its performance on nearly sorted arrays (e.g., one element out of place). Analyze the number of comparisons and shifts compared to unsorted inputs.</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch04_02.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch04_04.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch04_02.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch04_04.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/ferris.js"></script>


    </div>
    </body>
</html>
