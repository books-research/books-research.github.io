<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TaskScheduler - Java Data Structures and Algorithms for Beginners</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/ferris.css">
        <link rel="stylesheet" href="../../theme/semantic-notes.css">
        <link rel="stylesheet" href="../../theme/listing.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Java Data Structures and Algorithms for Beginners</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
body {
  text-align: justify;
}
</style>
<h1 id="task-scheduler"><a class="header" href="#task-scheduler">Task Scheduler</a></h1>
<h2 id="problem-statement"><a class="header" href="#problem-statement">Problem Statement</a></h2>
<p>Write a Java program that simulates a task scheduler using a priority queue. The program should enqueue tasks, each with a description (string) and priority (integer), and dequeue them in order of highest priority, printing each task as it is processed. The priority queue should ensure that tasks with higher priority numbers are dequeued first, and tasks with equal priorities are processed in FIFO order. Test the implementation with various sequences of enqueue and dequeue operations, including edge cases like empty queues and tasks with equal priorities. You can visualize this as a manager prioritizing urgent tasks in a to-do list, ensuring the most critical tasks are handled first.</p>
<p><strong>Input</strong>: A sequence of operations, where each operation is either:</p>
<ul>
<li>Enqueue: Add a task with a description (string) and priority (integer) to the priority queue (e.g., "Write report", 3).</li>
<li>Dequeue: Remove and process the task with the highest priority.
<strong>Output</strong>: For each operation, print the action performed (enqueue or dequeue) and, for dequeue, the processed task’s description or a message if the queue is empty.
<strong>Constraints</strong>:</li>
<li>Queue size is between 0 and 10^5.</li>
<li>Task descriptions are non-empty strings containing printable ASCII characters, or null (handled gracefully).</li>
<li>Priorities are integers in the range [-10^9, 10^9].</li>
<li>The queue may be empty when dequeue is called.
<strong>Example</strong>:</li>
<li>Input: Operations = [enqueue("Task1", 3), enqueue("Task2", 1), enqueue("Task3", 3), dequeue, dequeue]</li>
<li>Output:
<pre><code>Enqueued Task1 (priority 3)
Enqueued Task2 (priority 1)
Enqueued Task3 (priority 3)
Processed task: Task1
Processed task: Task3
</code></pre>
</li>
<li>Explanation: Task1 and Task3 (priority 3) are processed before Task2 (priority 1) due to higher priority.</li>
<li>Input: Operations = [dequeue on empty queue]</li>
<li>Output: <code>Queue empty, cannot dequeue</code></li>
</ul>
<h2 id="pseudocode"><a class="header" href="#pseudocode">Pseudocode</a></h2>
<pre><code>CLASS Task
    SET description to string
    SET priority to integer
ENDCLASS

CLASS PriorityQueue
    SET array to new Task array of size 1000
    SET size to 0
    
    FUNCTION enqueue(description, priority)
        IF size equals array length THEN
            RETURN false (queue full)
        ENDIF
        SET newTask to new Task(description, priority)
        SET array[size] to newTask
        CALL siftUp(size)
        INCREMENT size
        RETURN true
    ENDFUNCTION
    
    FUNCTION siftUp(index)
        WHILE index &gt; 0
            SET parent to (index - 1) / 2
            IF array[index].priority &lt;= array[parent].priority THEN
                BREAK
            ENDIF
            SWAP array[index] and array[parent]
            SET index to parent
        ENDWHILE
    ENDFUNCTION
    
    FUNCTION dequeue()
        IF size equals 0 THEN
            RETURN null (queue empty)
        ENDIF
        SET result to array[0]
        SET array[0] to array[size - 1]
        DECREMENT size
        IF size &gt; 0 THEN
            CALL siftDown(0)
        ENDIF
        RETURN result
    ENDFUNCTION
    
    FUNCTION siftDown(index)
        SET maxIndex to index
        WHILE true
            SET left to 2 * index + 1
            SET right to 2 * index + 2
            IF left &lt; size AND array[left].priority &gt; array[maxIndex].priority THEN
                SET maxIndex to left
            ENDIF
            IF right &lt; size AND array[right].priority &gt; array[maxIndex].priority THEN
                SET maxIndex to right
            ENDIF
            IF maxIndex equals index THEN
                BREAK
            ENDIF
            SWAP array[index] and array[maxIndex]
            SET index to maxIndex
        ENDWHILE
    ENDFUNCTION
    
    FUNCTION isEmpty()
        RETURN size equals 0
    ENDFUNCTION
ENDCLASS

FUNCTION simulateTaskScheduler(operations)
    CREATE queue as new PriorityQueue
    FOR each operation in operations
        IF operation.type equals "enqueue" THEN
            CALL queue.enqueue(operation.description, operation.priority)
            PRINT enqueued task and priority
        ELSE IF operation.type equals "dequeue" THEN
            SET task to queue.dequeue()
            IF task is null THEN
                PRINT queue empty message
            ELSE
                PRINT processed task description
            ENDIF
        ENDIF
    ENFOR
ENDFUNCTION

FUNCTION main()
    SET testCases to array of operation sequences
    FOR each testCase in testCases
        PRINT test case details
        CALL simulateTaskScheduler(testCase)
    ENDFOR
ENDFUNCTION
</code></pre>
<h2 id="algorithm-steps"><a class="header" href="#algorithm-steps">Algorithm Steps</a></h2>
<ol>
<li>Define a <code>Task</code> class to store task description (string) and priority (integer).</li>
<li>Define a <code>PriorityQueue</code> class using a max-heap with:
a. An array to store tasks, with <code>size</code> to track elements.
b. <code>enqueue</code>: Add task to end, sift up to maintain heap property.
c. <code>dequeue</code>: Remove root (highest priority), move last task to root, sift down.
d. <code>siftUp</code>: Move task up if its priority is higher than parent’s.
e. <code>siftDown</code>: Move task down to maintain max-heap property.
f. <code>isEmpty</code>: Check if queue is empty.</li>
<li>In <code>simulateTaskScheduler</code>:
a. Create a <code>PriorityQueue</code>.
b. For each operation:
<ul>
<li>If "enqueue", add task with priority, print action.</li>
<li>If "dequeue", remove highest-priority task, print task or "Queue empty".</li>
</ul>
</li>
<li>In <code>main</code>, test with sequences of enqueue and dequeue operations, including empty queues, single tasks, and equal priorities.</li>
</ol>
<h2 id="java-implementation"><a class="header" href="#java-implementation">Java Implementation</a></h2>
<pre><code class="language-java">import java.util.*;

public class TaskScheduler {
    // Task class to store description and priority
    static class Task {
        String description;
        int priority;

        Task(String description, int priority) {
            this.description = description;
            this.priority = priority;
        }
    }

    // Custom priority queue implementation (max-heap)
    static class PriorityQueue {
        private Task[] array;
        private int size;
        private static final int DEFAULT_SIZE = 1000;

        public PriorityQueue() {
            array = new Task[DEFAULT_SIZE];
            size = 0;
        }

        public boolean enqueue(String description, int priority) {
            if (size == array.length) {
                return false; // Queue full
            }
            Task newTask = new Task(description, priority);
            array[size] = newTask;
            siftUp(size);
            size++;
            return true;
        }

        private void siftUp(int index) {
            while (index &gt; 0) {
                int parent = (index - 1) / 2;
                if (array[index].priority &lt;= array[parent].priority) {
                    break;
                }
                // Swap
                Task temp = array[index];
                array[index] = array[parent];
                array[parent] = temp;
                index = parent;
            }
        }

        public Task dequeue() {
            if (size == 0) {
                return null; // Queue empty
            }
            Task result = array[0];
            array[0] = array[size - 1];
            size--;
            if (size &gt; 0) {
                siftDown(0);
            }
            return result;
        }

        private void siftDown(int index) {
            int maxIndex = index;
            while (true) {
                int left = 2 * index + 1;
                int right = 2 * index + 2;
                if (left &lt; size &amp;&amp; array[left].priority &gt; array[maxIndex].priority) {
                    maxIndex = left;
                }
                if (right &lt; size &amp;&amp; array[right].priority &gt; array[maxIndex].priority) {
                    maxIndex = right;
                }
                if (maxIndex == index) {
                    break;
                }
                // Swap
                Task temp = array[index];
                array[index] = array[maxIndex];
                array[maxIndex] = temp;
                index = maxIndex;
            }
        }

        public boolean isEmpty() {
            return size == 0;
        }
    }

    // Helper class for operations
    static class Operation {
        String type;
        String description;
        Integer priority;

        Operation(String type, String description, Integer priority) {
            this.type = type;
            this.description = description;
            this.priority = priority;
        }
    }

    // Simulates task scheduler
    public void simulateTaskScheduler(List&lt;Operation&gt; operations) {
        PriorityQueue queue = new PriorityQueue();
        for (Operation op : operations) {
            if (op.type.equals("enqueue")) {
                boolean success = queue.enqueue(op.description, op.priority);
                if (success) {
                    System.out.println("Enqueued " + (op.description != null ? op.description : "null") + 
                                      " (priority " + op.priority + ")");
                } else {
                    System.out.println("Enqueue " + (op.description != null ? op.description : "null") + 
                                      " failed: Queue full");
                }
            } else if (op.type.equals("dequeue")) {
                Task task = queue.dequeue();
                if (task == null) {
                    System.out.println("Queue empty, cannot dequeue");
                } else {
                    System.out.println("Processed task: " + task.description);
                }
            }
        }
    }

    // Main method to test task scheduler
    public static void main(String[] args) {
        TaskScheduler scheduler = new TaskScheduler();

        // Test cases
        List&lt;List&lt;Operation&gt;&gt; testCases = new ArrayList&lt;&gt;();
        
        // Test case 1: Normal sequence
        List&lt;Operation&gt; case1 = Arrays.asList(
            new Operation("enqueue", "Write report", 3),
            new Operation("enqueue", "Send email", 1),
            new Operation("enqueue", "Attend meeting", 3),
            new Operation("dequeue", null, null),
            new Operation("dequeue", null, null)
        );
        testCases.add(case1);
        
        // Test case 2: Empty queue
        List&lt;Operation&gt; case2 = Arrays.asList(
            new Operation("dequeue", null, null)
        );
        testCases.add(case2);
        
        // Test case 3: Single task
        List&lt;Operation&gt; case3 = Arrays.asList(
            new Operation("enqueue", "Debug code", 5),
            new Operation("dequeue", null, null)
        );
        testCases.add(case3);
        
        // Test case 4: Equal priorities
        List&lt;Operation&gt; case4 = Arrays.asList(
            new Operation("enqueue", "Task A", 2),
            new Operation("enqueue", "Task B", 2),
            new Operation("enqueue", "Task C", 2),
            new Operation("dequeue", null, null),
            new Operation("dequeue", null, null)
        );
        testCases.add(case4);
        
        // Test case 5: Null task description
        List&lt;Operation&gt; case5 = Arrays.asList(
            new Operation("enqueue", null, 4),
            new Operation("dequeue", null, null)
        );
        testCases.add(case5);

        // Run test cases
        for (int i = 0; i &lt; testCases.size(); i++) {
            System.out.println("Test case " + (i + 1) + ":");
            scheduler.simulateTaskScheduler(testCases.get(i));
            System.out.println();
        }
    }
}
</code></pre>
<h2 id="output"><a class="header" href="#output">Output</a></h2>
<p>Running the <code>main</code> method produces:</p>
<pre><code>Test case 1:
Enqueued Write report (priority 3)
Enqueued Send email (priority 1)
Enqueued Attend meeting (priority 3)
Processed task: Write report
Processed task: Attend meeting

Test case 2:
Queue empty, cannot dequeue

Test case 3:
Enqueued Debug code (priority 5)
Processed task: Debug code

Test case 4:
Enqueued Task A (priority 2)
Enqueued Task B (priority 2)
Enqueued Task C (priority 2)
Processed task: Task A
Processed task: Task B

Test case 5:
Enqueued null (priority 4)
Processed task: null
</code></pre>
<p>Explanation:</p>
<ul>
<li>Test case 1: Enqueues tasks with priorities 3, 1, 3; dequeues highest-priority tasks (Write report, Attend meeting) before Send email.</li>
<li>Test case 2: Dequeue on empty queue returns error.</li>
<li>Test case 3: Enqueues and dequeues a single task.</li>
<li>Test case 4: Enqueues three tasks with equal priority (2), processes in FIFO order (Task A, Task B).</li>
<li>Test case 5: Enqueues and dequeues a task with null description.</li>
</ul>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How It Works</a></h2>
<ul>
<li><strong>Task</strong>: Stores a task’s description and priority.</li>
<li><strong>PriorityQueue</strong>:
<ul>
<li>Uses a max-heap array to store tasks, ensuring highest-priority task is at root.</li>
<li><code>enqueue</code>: Adds task to end, sifts up to maintain heap property.</li>
<li><code>dequeue</code>: Removes root, moves last task to root, sifts down.</li>
<li>Equal priorities maintain FIFO order due to heap insertion order.</li>
</ul>
</li>
<li><strong>simulateTaskScheduler</strong>:
<ul>
<li>Enqueues tasks, printing action and priority.</li>
<li>Dequeues highest-priority task, printing description or "Queue empty".</li>
</ul>
</li>
<li><strong>Example Trace (Test case 1)</strong>:
<ul>
<li>Enqueue "Write report" (3): array=[(Write report,3)], size=1.</li>
<li>Enqueue "Send email" (1): array=[(Write report,3),(Send email,1)], size=2.</li>
<li>Enqueue "Attend meeting" (3): array=[(Attend meeting,3),(Send email,1),(Write report,3)], size=3 (after sift-up).</li>
<li>Dequeue: Returns "Attend meeting", array=[(Write report,3),(Send email,1)], size=2 (after sift-down).</li>
<li>Dequeue: Returns "Write report", array=[(Send email,1)], size=1.</li>
</ul>
</li>
<li><strong>Main Method</strong>: Tests normal sequences, empty queue, single task, equal priorities, and null description.</li>
</ul>
<h2 id="complexity-analysis-table"><a class="header" href="#complexity-analysis-table">Complexity Analysis Table</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th><th>Space Complexity</th></tr></thead><tbody>
<tr><td>Enqueue</td><td>O(log n)</td><td>O(1)</td></tr>
<tr><td>Dequeue</td><td>O(log n)</td><td>O(1)</td></tr>
<tr><td>Full Algorithm</td><td>O(n log n)</td><td>O(n)</td></tr>
</tbody></table>
</div>
<p><em>Note</em>:</p>
<ul>
<li>n is the number of operations.</li>
<li>Time complexity: O(log n) for enqueue/dequeue due to heap operations; O(n log n) for n operations.</li>
<li>Space complexity: O(n) for storing up to n tasks.</li>
<li>Worst case: O(n log n) time for n enqueue/dequeue operations, O(n) space.</li>
</ul>
<blockquote>
<p><strong>✅ Tip</strong>: Use a max-heap for a priority queue to ensure highest-priority tasks are processed first. Test with equal priorities to verify FIFO behavior for same-priority tasks.</p>
</blockquote>
<blockquote>
<p><strong>⚠ Warning</strong>: Handle null descriptions and empty queue cases to avoid errors. Ensure the heap maintains its property after each enqueue and dequeue operation.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../problemStatements/ch03_05_01/MinHeapToMaxHeap.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../problemStatements/linkedListProblemSolving.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../problemStatements/ch03_05_01/MinHeapToMaxHeap.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../problemStatements/linkedListProblemSolving.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/ferris.js"></script>


    </div>
    </body>
</html>
