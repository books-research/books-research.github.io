<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>RangeSumQuery - Java Data Structures and Algorithms for Beginners</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/ferris.css">
        <link rel="stylesheet" href="../../theme/semantic-notes.css">
        <link rel="stylesheet" href="../../theme/listing.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Java Data Structures and Algorithms for Beginners</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
body {
  text-align: justify;
}
</style>
<h1 id="range-sum-query"><a class="header" href="#range-sum-query">Range Sum Query</a></h1>
<h2 id="problem-statement"><a class="header" href="#problem-statement">Problem Statement</a></h2>
<p>Write a Java program that uses a Binary Search Tree (BST) to find the sum of all node values within a given range (e.g., between 20 and 60, inclusive). The program should use inorder traversal to collect values, leveraging the BST property to optimize by pruning branches outside the range. The implementation should reuse the BST node structure and test the range sum query with various trees and ranges, including edge cases like empty trees, ranges with no values in the tree, and ranges covering all or none of the tree’s values. You can visualize this as summing the ages of family members in a family tree whose ages fall within a specific range, using the tree’s ordered structure to efficiently skip irrelevant branches.</p>
<p><strong>Input</strong>:</p>
<ul>
<li>A BST represented by nodes with integer values.</li>
<li>Two integers, <code>low</code> and <code>high</code>, defining the inclusive range [low, high].
<strong>Output</strong>: An integer representing the sum of all node values within [low, high], and a string representation of the tree for clarity.
<strong>Constraints</strong>:</li>
<li>The tree has between 0 and 10^5 nodes.</li>
<li>Node values, <code>low</code>, and <code>high</code> are integers in the range [-10^9, 10^9].</li>
<li>Duplicate values are not allowed in the BST.</li>
<li><code>low</code> ≤ <code>high</code>.
<strong>Example</strong>:</li>
<li>Input: Tree = [5, left: [3, left: [1], right: [4]], right: [7]], Range = [2, 6]</li>
<li>Output: Sum = 12, "Preorder: 5 3 1 4 7"</li>
<li>Explanation: Values 3, 4, 5 are in [2, 6], sum = 3 + 4 + 5 = 12.</li>
<li>Input: Tree = [5, left: [3, left: [1], right: [4]], right: [7]], Range = [8, 10]</li>
<li>Output: Sum = 0, "Preorder: 5 3 1 4 7"</li>
<li>Explanation: No values in [8, 10], sum = 0.</li>
<li>Input: Tree = [], Range = [1, 5]</li>
<li>Output: Sum = 0, "Empty"</li>
<li>Explanation: Empty tree, sum = 0.</li>
</ul>
<h2 id="pseudocode"><a class="header" href="#pseudocode">Pseudocode</a></h2>
<pre><code>CLASS Node
    SET value to integer
    SET left to Node (null by default)
    SET right to Node (null by default)
ENDCLASS

FUNCTION rangeSum(root, low, high)
    IF root is null THEN
        RETURN 0
    ENDIF
    IF root.value &lt; low THEN
        RETURN rangeSum(root.right, low, high)
    ENDIF
    IF root.value &gt; high THEN
        RETURN rangeSum(root.left, low, high)
    ENDIF
    RETURN root.value + rangeSum(root.left, low, high) + rangeSum(root.right, low, high)
ENDFUNCTION

FUNCTION toString(root)
    IF root is null THEN
        RETURN "Empty"
    ENDIF
    CREATE result as new StringBuilder
    FUNCTION preorder(node)
        IF node is null THEN
            RETURN
        ENDIF
        APPEND node.value and " " to result
        CALL preorder(node.left)
        CALL preorder(node.right)
    ENDFUNCTION
    CALL preorder(root)
    RETURN "Preorder: " + result as string
ENDFUNCTION

FUNCTION main()
    SET testCases to array of (tree, low, high) pairs
    FOR each testCase in testCases
        PRINT test case details
        CALL rangeSum(testCase.root, testCase.low, testCase.high)
        PRINT sum and tree using toString
    ENDFOR
ENDFUNCTION
</code></pre>
<h2 id="algorithm-steps"><a class="header" href="#algorithm-steps">Algorithm Steps</a></h2>
<ol>
<li>Reuse the <code>Node</code> class with:
a. An integer <code>value</code>.
b. <code>left</code> and <code>right</code> pointers to child nodes.</li>
<li>Define <code>rangeSum</code>:
a. If root is null, return 0.
b. If root.value &lt; low, skip left subtree, recurse on right.
c. If root.value &gt; high, skip right subtree, recurse on left.
d. If root.value is in [low, high], include value and recurse on both subtrees.</li>
<li>Define <code>toString</code>:
a. If root is null, return "Empty".
b. Perform preorder traversal, appending values to a string.</li>
<li>In <code>main</code>, test with:
a. A tree with values in the range.
b. A tree with no values in the range.
c. An empty tree.
d. A range covering all values.
e. A single-node tree.</li>
</ol>
<h2 id="java-implementation"><a class="header" href="#java-implementation">Java Implementation</a></h2>
<pre><code class="language-java">public class RangeSumQuery {
    // Node class for the binary search tree
    static class Node {
        int value;
        Node left, right;

        Node(int value) {
            this.value = value;
            this.left = null;
            this.right = null;
        }
    }

    // Computes the sum of values in the range [low, high]
    public int rangeSum(Node root, int low, int high) {
        if (root == null) {
            return 0;
        }
        if (root.value &lt; low) {
            return rangeSum(root.right, low, high);
        }
        if (root.value &gt; high) {
            return rangeSum(root.left, low, high);
        }
        return root.value + rangeSum(root.left, low, high) + rangeSum(root.right, low, high);
    }

    // Converts tree to string (preorder traversal)
    public String toString(Node root) {
        if (root == null) {
            return "Empty";
        }
        StringBuilder result = new StringBuilder();
        preorder(root, result);
        return "Preorder: " + result.toString().trim();
    }

    private void preorder(Node node, StringBuilder result) {
        if (node == null) {
            return;
        }
        result.append(node.value).append(" ");
        preorder(node.left, result);
        preorder(node.right, result);
    }

    // Helper class for test cases
    static class TestCase {
        Node root;
        int low, high;

        TestCase(int[] values, int[][] edges, int low, int high) {
            this.low = low;
            this.high = high;
            if (values.length == 0) {
                root = null;
                return;
            }
            Node[] nodes = new Node[values.length];
            for (int i = 0; i &lt; values.length; i++) {
                nodes[i] = new Node(values[i]);
            }
            for (int[] edge : edges) {
                int parent = edge[0], child = edge[1];
                if (edge[2] == 0) {
                    nodes[parent].left = nodes[child];
                } else {
                    nodes[parent].right = nodes[child];
                }
            }
            root = nodes[0];
        }
    }

    // Main method to test range sum query
    public static void main(String[] args) {
        RangeSumQuery query = new RangeSumQuery();

        // Test cases
        TestCase[] testCases = {
            // Values in range: [5, left: [3, left: 1, right: 4], right: 7], range [2, 6]
            new TestCase(
                new int[]{5, 3, 1, 4, 7},
                new int[][]{{0, 1, 0}, {0, 4, 1}, {1, 2, 0}, {1, 3, 1}},
                2, 6
            ),
            // No values in range: [5, left: [3, left: 1, right: 4], right: 7], range [8, 10]
            new TestCase(
                new int[]{5, 3, 1, 4, 7},
                new int[][]{{0, 1, 0}, {0, 4, 1}, {1, 2, 0}, {1, 3, 1}},
                8, 10
            ),
            // Empty tree: [], range [1, 5]
            new TestCase(new int[]{}, new int[][]{}, 1, 5),
            // Range covers all: [5, left: [3, left: 1, right: 4], right: 7], range [0, 10]
            new TestCase(
                new int[]{5, 3, 1, 4, 7},
                new int[][]{{0, 1, 0}, {0, 4, 1}, {1, 2, 0}, {1, 3, 1}},
                0, 10
            ),
            // Single node: [10], range [5, 15]
            new TestCase(new int[]{10}, new int[][]{}, 5, 15)
        };

        // Run test cases
        for (int i = 0; i &lt; testCases.length; i++) {
            System.out.println("Test case " + (i + 1) + ":");
            System.out.println("Tree: " + query.toString(testCases[i].root));
            System.out.println("Range: [" + testCases[i].low + ", " + testCases[i].high + "]");
            int sum = query.rangeSum(testCases[i].root, testCases[i].low, testCases[i].high);
            System.out.println("Sum: " + sum + "\n");
        }
    }
}
</code></pre>
<h2 id="output"><a class="header" href="#output">Output</a></h2>
<p>Running the <code>main</code> method produces:</p>
<pre><code>Test case 1:
Tree: Preorder: 5 3 1 4 7
Range: [2, 6]
Sum: 12

Test case 2:
Tree: Preorder: 5 3 1 4 7
Range: [8, 10]
Sum: 0

Test case 3:
Tree: Empty
Range: [1, 5]
Sum: 0

Test case 4:
Tree: Preorder: 5 3 1 4 7
Range: [0, 10]
Sum: 20

Test case 5:
Tree: Preorder: 10
Range: [5, 15]
Sum: 10
</code></pre>
<p>Explanation:</p>
<ul>
<li>Test case 1: Values 3, 4, 5 are in [2, 6], sum = 3 + 4 + 5 = 12.</li>
<li>Test case 2: No values in [8, 10], sum = 0.</li>
<li>Test case 3: Empty tree, sum = 0.</li>
<li>Test case 4: All values (1, 3, 4, 5, 7) in [0, 10], sum = 1 + 3 + 4 + 5 + 7 = 20.</li>
<li>Test case 5: Single node 10 in [5, 15], sum = 10.</li>
</ul>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How It Works</a></h2>
<ul>
<li><strong>Node</strong>: Stores an integer value and pointers to left and right children.</li>
<li><strong>rangeSum</strong>:
<ul>
<li>Returns 0 for null nodes.</li>
<li>If root.value &lt; low, skips left subtree, recurses on right.</li>
<li>If root.value &gt; high, skips right subtree, recurses on left.</li>
<li>If root.value in [low, high], includes value and recurses on both subtrees.</li>
</ul>
</li>
<li><strong>toString</strong>: Performs preorder traversal, returns space-separated values or "Empty".</li>
<li><strong>Example Trace (Test case 1)</strong>:
<ul>
<li>Root=5: In [2, 6], sum = 5 + rangeSum(left, 2, 6) + rangeSum(right, 2, 6).</li>
<li>Left=3: In [2, 6], sum = 3 + rangeSum(left=1, 2, 6) + rangeSum(right=4, 2, 6).</li>
<li>Left=1: Not in [2, 6], skip left, sum = rangeSum(right=null, 2, 6) = 0.</li>
<li>Right=4: In [2, 6], sum = 4 + rangeSum(null, 2, 6) + rangeSum(null, 2, 6) = 4.</li>
<li>Right=7: &gt; 6, skip right, sum = rangeSum(left=null, 2, 6) = 0.</li>
<li>Total: 5 + (3 + 0 + 4) + 0 = 12.</li>
</ul>
</li>
<li><strong>Main Method</strong>: Tests range with values, no values, empty tree, all values, and single node.</li>
</ul>
<h2 id="complexity-analysis-table"><a class="header" href="#complexity-analysis-table">Complexity Analysis Table</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th><th>Space Complexity</th></tr></thead><tbody>
<tr><td>rangeSum</td><td>O(n) worst case</td><td>O(h)</td></tr>
<tr><td>toString</td><td>O(n)</td><td>O(h)</td></tr>
</tbody></table>
</div>
<p><em>Note</em>:</p>
<ul>
<li>n is the number of nodes in the tree.</li>
<li>h is the height of the tree (O(n) for skewed, O(log n) for balanced).</li>
<li>Time complexity: O(n) for rangeSum in worst case (all nodes in range); O(h) in best case (pruning skips subtrees).</li>
<li>Space complexity: O(h) for recursion stack in rangeSum and toString.</li>
<li>Worst case: O(n) time and O(n) space for skewed trees with all nodes in range.</li>
</ul>
<blockquote>
<p><strong>✅ Tip</strong>: Leverage the BST property to prune branches outside the range, reducing unnecessary traversals. Use inorder traversal logic to ensure values are processed in sorted order.</p>
</blockquote>
<blockquote>
<p><strong>⚠ Warning</strong>: Ensure the range is inclusive ([low, high]) and handle edge cases like empty trees or ranges outside the tree’s values to avoid incorrect sums.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../problemStatements/ch03_07/PreorderPostorderTraversals.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../problemStatements/graphsProblemSolving.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../problemStatements/ch03_07/PreorderPostorderTraversals.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../problemStatements/graphsProblemSolving.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/ferris.js"></script>


    </div>
    </body>
</html>
